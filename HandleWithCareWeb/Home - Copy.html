<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <title>Word Add-In with Commands Sample</title>

    <script src="Scripts/jquery-1.9.1.js" type="text/javascript"></script>
    <!--<script src="Scripts/FabricUI/MessageBanner.js" type="text/javascript"></script>-->
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" type="text/javascript"></script>
    <script type='text/javascript' src='https://www.bing.com/api/maps/mapcontrol?key=AlfuN19Q15ip-9iDKpDbc7flP3fKC27t9j88vIkRq-majvto7wRneRIF3p9OqXJp'></script>
    <script type='text/javascript'>
        var map;
        function loadMapScenario() {
            //map = new Microsoft.Maps.Map(document.getElementById('myMap'), {
                //center: new Microsoft.Maps.Location(51.50632, -0.12714),
                //mapTypeId: Microsoft.Maps.MapTypeId.aerial,
                //zoom: 10
            //});

            //map.setOptions({
            //    mapTypeId: Microsoft.Maps.MapTypeId.aerial,
            //    center: new Microsoft.Maps.Location(35.027222, -111.0225),
            //    zoom: 15
            //});


            //var pushpinInfos = []; 
            //pushpinInfos[0] = { 'lat': 47.616798, 'lng': -122.205101, 'title': 'Bellevue Square Microsoft Store', 'description': '116 Bellevue Sq, Bellevue, WA 98004' };
            //pushpinInfos[1] = { 'lat': 47.642101, 'lng': -122.137001, 'title': 'Microsoft Visitor Center', 'description': '15010 NE 36th Street Microsoft Campus Building 92, Redmond, WA 98052' };

            var storeData = [
                {
                    'state': 'Oregon',
                    'stores': [ 
                        { 'lat': 45.517487, 'lng': -122.676361, 'title': 'Microsoft Store - Pioneer Place', 'description': '300 SW Yamhill St, Portland, OR 97204' }
                    ]
                },
                {
                    'state': 'Washington',
                    'stores': [
                        { 'lat': 47.616798, 'lng': -122.205101, 'title': 'Microsoft Store - Bellevue Square Mall', 'description': '116 Bellevue Sq, Bellevue, WA 98004' },
                        { 'lat': 47.642101, 'lng': -122.137001, 'title': 'Microsoft Visitor Center', 'description': '15010 NE 36th Street Microsoft Campus Building 92, Redmond, WA 98052' }
                    ]
                },
            ]


            var infoboxLayer = new Microsoft.Maps.EntityCollection();
            var pinLayer = new Microsoft.Maps.EntityCollection();
            var apiKey = "AlfuN19Q15ip-9iDKpDbc7flP3fKC27t9j88vIkRq-majvto7wRneRIF3p9OqXJp";

            var map = new Microsoft.Maps.Map(document.getElementById("myMap"), { credentials: apiKey });

            // Create the info box for the pushpin
            pinInfobox = new Microsoft.Maps.Infobox(new Microsoft.Maps.Location(0, 0), { visible: false });
            infoboxLayer.push(pinInfobox);

            var locs = [];
            for (var i = 0; i < storeData.length; i++) {
                $('#stateList').append($('<option>', { value: storeData[i].state, text: storeData[i].state }));
            }

            for (var i = 0; i < storeData[0].stores.length; i++) {
                locs[i] = new Microsoft.Maps.Location(storeData[0].stores[i].lat, storeData[0].stores[i].lng);
                var pin = new Microsoft.Maps.Pushpin(locs[i]);
                pin.Title = storeData[0].stores[i].title;
                pin.Description = storeData[0].stores[i].description;
                pinLayer.push(pin);
                Microsoft.Maps.Events.addHandler(pin, 'click', displayInfobox);
            }
            //for (var i = 0; i < pushpinInfos.length; i++) {
            //    locs[i] = new Microsoft.Maps.Location(pushpinInfos[i].lat, pushpinInfos[i].lng);
            //    var pin = new Microsoft.Maps.Pushpin(locs[i]);
            //    pin.Title = pushpinInfos[i].title;
            //    pin.Description = pushpinInfos[i].description;
            //    pinLayer.push(pin);
            //    Microsoft.Maps.Events.addHandler(pin, 'click', displayInfobox);
            //}

            map.entities.push(pinLayer);
            map.entities.push(infoboxLayer);

            var bestview = Microsoft.Maps.LocationRect.fromLocations(locs);
            map.setView({ center: bestview.center, zoom: 10 });
        }

        function displayInfobox(e) {
            pinInfobox.setOptions({ title: e.target.Title, description: e.target.Description, visible: true, offset: new Microsoft.Maps.Point(0, 25) });
            pinInfobox.setLocation(e.target.getLocation());
        }

        function hideInfobox(e) {
            pinInfobox.setOptions({ visible: false });
        }
    </script>

    <!-- <script src="Scripts/Office/1/office.js" type="text/javascript"></script>  -->

    <link href="Home.css" rel="stylesheet" type="text/css" />
    <!--<script src="Home.js" type="text/javascript"></script>-->

    <!-- For the Office UI Fabric, go to https://aka.ms/office-ui-fabric to learn more. -->
    <link rel="stylesheet" href="https://appsforoffice.microsoft.com/fabric/2.1.0/fabric.min.css">
    <link rel="stylesheet" href="https://appsforoffice.microsoft.com/fabric/2.1.0/fabric.components.min.css">

    <!-- To enable the offline use of Office UI Fabric, use: -->
    <!-- link rel="stylesheet" href="Content/fabric.min.css" -->
    <!-- link rel="stylesheet" href="Content/fabric.components.min.css" -->
</head>
<body onload="loadMapScenario();">
    <div id="myMap" style="width: 100vw; height: 50vh;"></div>
    <br />
    <div>
        <select id="stateList">
            <option value="NotSelected">Select a state</option>
        </select>
    </div>

    <!--<div id="content-main">
        <div class="padding">
            <br />
            <p class="ms-font-xxl ms-fontColor-neutralSecondary ms-fontWeight-semilight">Sample</p>
            <br /><br />
            <div class="ms-font-xl ms-fontColor-neutralTertiary">Select some text</div>
            <p class="ms-font-m-plus ms-fontColor-neutralTertiary" id="template-description"></p>
            <div class="ms-font-m"><a target="_blank" class="ms-Link ms-Link--hero" href="https://go.microsoft.com/fwlink/?LinkId=276812">Find more samples online...</a></div>
            <br /><br />

            <button class="ms-Button ms-Button--primary" id="highlight-button">
                <span class="ms-Button-icon"><i class="ms-Icon ms-Icon--plus"></i></span>
                <span class="ms-Button-label" id="button-text"></span>
                <span class="ms-Button-description" id="button-desc"></span>
            </button>
        </div>
    </div>-->
    <!--<div class="footer">
        <div class="ms-Grid ms-bgColor-themeSecondary">
            <div class="ms-Grid-row">
                <div class="ms-Grid-col ms-u-sm12 ms-u-md12 ms-u-lg12"> <div class="ms-font-xl ms-fontColor-white">Contoso</div></div>
            </div>
        </div>
    </div>-->

    <!-- FabricUI component used for displaying notifications -->
    <!--<div class="ms-MessageBanner" id="notification-popup">
        <div class="ms-MessageBanner-content">
            <div class="ms-MessageBanner-text">
                <div class="ms-MessageBanner-clipper">
                    <div class="ms-font-m-plus ms-fontWeight-semibold" id="notification-header"></div>
                    <div class="ms-font-m ms-fontWeight-semilight" id="notification-body"></div>
                </div>
            </div>
            <button class="ms-MessageBanner-expand" style="display:none"><i class="ms-Icon ms-Icon--chevronsDown"></i> </button>
            <div class="ms-MessageBanner-action"></div>
        </div>
        <button class="ms-MessageBanner-close"> <i class="ms-Icon ms-Icon--x"></i> </button>
    </div>-->
</body>
</html>
